{% extends "base.html" %}
{% from "_pagination.html" import pager %}
{% block title %}Логи стратегий{% endblock %}

{% block content %}
<h2 style="margin-bottom:16px;">Логи стратегий</h2>
<div class="logs-list" style="overflow-x:auto;">
    <table class="data-table">
        <tr>
            <th>ID</th>
            <th>Deal ID</th>
            <th>Стратегия</th>
            <th>Сигнал</th>
            <th>Комментарий</th>
            <th>Дата/время</th>
        </tr>
        {% for log in items %}
        <tr style="text-align:center;">
            <td>{{ log.id }}</td>
            <td>
                {% if log.deal_id %}
                    <a href="/deals/ui/{{ log.deal_id }}/" class="link-gold">{{ log.deal_id }}</a>
                {% else %}-{% endif %}
            </td>
            <td>{{ log.strategy }}</td>
            <td>{{ log.signal }}</td>
            <td style="max-width:350px;overflow-x:auto;">{{ log.comment }}</td>
            <td>{{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') if log.timestamp else '-' }}</td>
        </tr>
        {% endfor %}
        {% if not logs %}
        <tr><td colspan="6" style="text-align:center; color:#aaa;">Логи отсутствуют</td></tr>
        {% endif %}
    </table>
</div>
{{ pager(page=page or 1, pages=pages or 1, per_page=per_page or 20) }}

    <div style="margin-top:10px;">
    На странице:
    {% set pp = per_page or 20 %}
    {% for n in [10,20,50,100] %}
        {% if pp == n %}
        <strong>{{ n }}</strong>
        {% else %}
        <a href="?page=1&per_page={{ n }}">{{ n }}</a>
        {% endif %}
        {% if not loop.last %} | {% endif %}
    {% endfor %}
    </div>
<br>
{% if deal_id %}
  <a href="/logs/" class="button-secondary">Показать все логи</a>
{% endif %}
{% endblock %}
