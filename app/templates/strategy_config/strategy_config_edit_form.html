{% extends "base.html" %}
{% block title %}Редактировать стратегию{% endblock %}
{% block content %}
<div class="strategy-form">
    <h2>Редактировать стратегию #{{ config.id }}</h2>
    <form method="post" action="/strategy-config/{{ config.id }}/edit/">
        <label>Название:
            <input type="text" name="name" value="{{ config.name }}" required>
        </label>
        <label>Описание:
            <textarea name="description" rows="3">{{ config.description }}</textarea>
        </label>
        <label>Активна:
            <select name="is_active">
                <option value="True" {% if config.is_active %}selected{% endif %}>Да</option>
                <option value="False" {% if not config.is_active %}selected{% endif %}>Нет</option>
            </select>
        </label>
        <label>Параметры (JSON):
            {% if should_show_percentage_format(config.parameters) %}
                <textarea name="parameters" rows="10" required>{% set formatted_params = format_params_for_display(config.parameters) %}
{% for key, value in formatted_params.items() %}
  "{{ key }}": {% if key in ['ema_fast', 'ema_slow'] %}{{ value }}{% else %}"{{ value }}"{% endif %}{% if not loop.last %},{% endif %}
{% endfor %}</textarea>
                <small><em>Процентные параметры показаны в процентах, но будут сохранены в долях</em></small>
            {% else %}
                <textarea name="parameters" rows="7" required>{{ config.parameters | tojson(indent=2) }}</textarea>
            {% endif %}
        </label>
        <button type="submit" class="button">Сохранить</button>
    </form>
    <a href="/strategy-config/list/" class="button-secondary">Назад к списку</a>
</div>
{% endblock %}
